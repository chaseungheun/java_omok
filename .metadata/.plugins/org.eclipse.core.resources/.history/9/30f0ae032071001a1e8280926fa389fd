<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="./resources/css/style.css">

<title>Insert title here</title>
</head>
<body>

	<p>게임번호 = ${room} 플레이어 = ${player}</p>
	<p class="turn"></p>
	    <div class="board">
        <div class="row-1 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-2 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-3 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-4 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-5 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-6 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-7 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-8 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-9 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-10 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-11 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-12 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-13 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-14 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
        <div class="row-15 row">
            <div class="col-1 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-2 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-3 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-4 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-5 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-6 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-7 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-8 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-9 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-10 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-11 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-12 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-13 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-14 col">
                <div class="col__grid"></div>
            </div>
            <div class="col-15 col">
                <div class="col__grid"></div>
            </div>
        </div>
    </div>
    
    
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" >
    let locationXY = {x : '', y : ''};
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.col').forEach(el => { // el(=element) -> 선택한 요소
            el.addEventListener('click', e => { // e (=event) -> MouseEvent가 들어왔을 때

                locationXY.x = el.classList[0].split('-')[1];
                locationXY.y = el.closest('.row').classList[0].split('-')[1];
                console.log(locationXY);

               	$(document).ready(function(){//ajax시작
               		$(".col").click(function(e){
               			const mydata = { 
               					room: ${room},
               					player: ${player},
               					locx:locationXY.x,
               					locy:locationXY.y,
               					refresh:"0"
               			};
            			
            			$.ajax({
            				url:"putStone",
            				type:"POST",
            				data:mydata,
            				success:function(data){
            					//console.log("???"+text(data));
            					let Bdata =[];
            					Bdata = data.split("@@")[0].trim().split("::");
            					let Wdata =[];
            					Wdata = data.split("@@")[1].trim().split("::");
            					
            					//console.log("모든 데이터"+data);console.log("흑돌"+Bdata);console.log("백돌"+Wdata);
            					for(let i =0;i<Bdata.length;i++){
            							if(Bdata[i] !==""){
            								//console.log(Bdata[i]+"흑돌");
            								let x = Bdata[i].split(",")[0];
            								let y = Bdata[i].split(",")[1];
            								$(".row-"+y).children(".col-"+x).addClass("black");
            								
            							}
            					}
            					for(let i =0;i<Wdata.length;i++){
        							if(Wdata[i] !==""){
        								//console.log(Wdata[i]+"백돌");
        								let x = Wdata[i].split(",")[0];
        								let y = Wdata[i].split(",")[1];
        								$(".row-"+y).children(".col-"+x).addClass("white");
        								
        							}
        					}
            					let turn = data.split("@@")[2];
            					if(turn === ${player}){
            						$('.turn').text("당신 차례 입니다.");
            					}
            					else{
            						$('.turn').text("상대 차례 입니다.");
            					}
            				},
            				error:function(){}
            			});//ajax 사용하여 데이터 송수신
               		});//클릭 이벤트
               	}); // ajax 끝
            })
        })
        
    })
    
    
    
    $(document).ready(function () {
			const mydata = { 
   					room: ${room},
   					player: ${player},
   					locx:locationXY.x,
   					locy:locationXY.y,
   					refresh:"1"
   			};
    
          setInterval(function () {

    			
    			$.ajax({
    				url:"putStone",
    				type:"POST",
    				data:mydata,
    				success:function(data){
    					//console.log("???"+text(data));
    					let Bdata =[];
    					Bdata = data.split("@@")[0].trim().split("::");
    					let Wdata =[];
    					Wdata = data.split("@@")[1].trim().split("::");
    					
    					//console.log("모든 데이터"+data);console.log("흑돌"+Bdata);console.log("백돌"+Wdata);
    					for(let i =0;i<Bdata.length;i++){
    							if(Bdata[i] !==""){
    								//console.log(Bdata[i]+"흑돌");
    								let x = Bdata[i].split(",")[0];
    								let y = Bdata[i].split(",")[1];
    								$(".row-"+y).children(".col-"+x).addClass("black");	
    							}
    					}
    					for(let i =0;i<Wdata.length;i++){
							if(Wdata[i] !==""){
								//console.log(Wdata[i]+"백돌");
								let x = Wdata[i].split(",")[0];
								let y = Wdata[i].split(",")[1];
								$(".row-"+y).children(".col-"+x).addClass("white");
								}
						}
    					console.log(turn+" ?? "+${player});
    					if( Bdata.length===Wdata.lenght){
    						if(${player}==='1'){
    							console.log("되긴대?")
    							$('.turn').text("당신 차례 입니다.");
    						}
    						else{
        						$('.turn').text("상대 차례 입니다.");
    						}
    					}
    					else{
    						if(${player}==='2'){
    							$('.turn').text("당신 차례 입니다.");
    						}
    						else{
        						$('.turn').text("상대 차례 입니다.");
    						}
    					}
    				}
    			})
          }, 500);
      });

	

   	
   	
    </script>
	    <div id ="displayArea">hhh</div>
	    <button>표시</button>
</body>
</html>
